{"expireTime":9007200860071785000,"key":"transformer-remark-markdown-html-c18c860b51efed81a92e814ada8b5621-gatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-prismjs-titlegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypantsgatsby-remark-prismjs-","val":"<h2>Cask に追加してみる</h2>\n<ol>\n<li>\n<p>homebrew を更新し、作業中は自動更新を止める</p>\n<p>まず<code class=\"language-text\">brew update</code>で更新をかけておきます、これで Cask 含め brew 本体も更新されます。</p>\n<p>次に、homebrew は Cask を自動更新する仕様なので作業中はこれを止めておきます。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">HOMEBREW_NO_AUTO_UPDATE</span><span class=\"token operator\">=</span><span class=\"token number\">1</span></code></pre></div>\n<p>環境変数なのでターミナルを開き直したあとや、別のターミナルには効きませんのでご注意を。</p>\n</li>\n<li>\n<p>Cask に追加したいアプリケーションをインストールしておく</p>\n<p>今までと同じようにブラウザでインストーラーなどをダウンロードし、インストールします。後々使うのでダウンロードしたファイルを消さないようにしましょう。</p>\n</li>\n<li>github 上で<a href=\"https://github.com/Homebrew/homebrew-cask\">homebrew-cask</a>を fork する</li>\n<li>\n<p>local 上の homebrew ディレクトリの git に fork したリポジトリを追加する</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token assign-left variable\">github_user</span><span class=\"token operator\">=</span><span class=\"token string\">'&lt;my-github-username>'</span>\n$ <span class=\"token builtin class-name\">cd</span> <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span>brew --repository<span class=\"token variable\">)</span></span>\"</span>/Library/Taps/Homebrew/homebrew-cask\n$ <span class=\"token function\">git</span> remote <span class=\"token function\">add</span> <span class=\"token string\">\"<span class=\"token variable\">${github_user}</span>\"</span> <span class=\"token string\">\"https://github.com/<span class=\"token variable\">${github_user}</span>/homebrew-cask\"</span></code></pre></div>\n</li>\n<li>\n<p>Cask 名を決める</p>\n<p>いわゆる<code class=\"language-text\">brew cask install 〇〇</code>のところの名前です。命名規則があるようなのですがこれを自動で決めてくれるコマンドがあります。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span>brew --repository<span class=\"token variable\">)</span></span>/Library/Taps/Homebrew/homebrew-cask/developer/bin/generate_cask_token\"</span> <span class=\"token string\">'/Applications/〇〇.app'</span></code></pre></div>\n</li>\n<li>\n<p>Cask の定義ファイルを作る</p>\n<p>定義ファイルは.rb ファイルのテキストです。Stanzas という記法らしいです。これもコマンドにて雛形を作ってくれます。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ brew cask create <span class=\"token punctuation\">{</span>Cask名<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>\n<p>定義ファイルを書く</p>\n<p><a href=\"https://github.com/Homebrew/homebrew-cask/blob/master/doc/development/adding_a_cask.md#cask-stanzas\">homebrew-cask の仕様</a>などを読みながら雛形の空欄を埋めていきます。</p>\n<p>ちなみに<code class=\"language-text\">SHA-256</code>の部分は.app ではなくダウンロードした.zip や.dmg などのファイルのハッシュ値です。これは以下のコマンドで確認できます。ダウンロードフォルダにファイルが残っていると思うので以下のような感じで確認できます。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ shasum -a <span class=\"token number\">256</span> <span class=\"token string\">\"~/Downloads/〇〇.zip\"</span></code></pre></div>\n<p>また、url にバージョンの数字などが含まれる場合は変数としておくことでバージョンアップ時に定義ファイルを自動更新できるので変更しておきましょう。変数は<code class=\"language-text\">#{version}</code>で置き換えることができます。ここで注意したいのは先のコマンドで作った雛形ではシングルクオートですが、変数を含める際にはダブルクオートでなければなりません。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Before url &#39;https://example.com/app-v1.0.1.zip&#39;\nAfter  url &quot;https://example.com/app-v#{version}.zip&quot;</code></pre></div>\n<p>name の部分にはスペースを含めることができます。大文字小文字やスペース位置などを正確に入力しておきましょう。</p>\n<p>app には<code class=\"language-text\">/Applications</code>にインストールされているファイル名を入力しておきます。</p>\n</li>\n<li>\n<p>書き上げた定義ファイルの確認</p>\n<p>まず実際にインストールできるか確認しましょう。手順の中ですでに PC 内にインストール済みなので、アンインストールするか、<code class=\"language-text\">-f</code>オプションで上書きしましょう。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ brew cask <span class=\"token function\">install</span> -f 〇〇</code></pre></div>\n<p>インストール後動作に問題がなければ OK です。</p>\n<p>定義ファイルのシンタックスチェックや、必要事項の記入漏れなどを確認・自動修正してくれるコマンドが備えれらています。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ brew cask audit 〇〇 --download\n$ brew cask style Casks/〇〇.rb\n\n$ brew cask style Casks/〇〇.rb --fix   // <span class=\"token operator\">&lt;</span>- 自動修正してくれます。</code></pre></div>\n<p>これにて定義ファイルが完成です。次は PR をしていきます。</p>\n</li>\n<li>\n<p>変更を commit・push する</p>\n<p>コミットメッセージにもガイドラインが決まっています。</p>\n<blockquote>\n<p>The first line is commit summary, 50 characters or less,<br>\nFollowed by an empty line,<br>\nFollowed by an explanation of the commit, wrapped to 72 characters.</p>\n</blockquote>\n<p><a href=\"https://github.com/Homebrew/homebrew-cask/blob/master/doc/development/adding_a_cask.md#commit-messages\">ここ</a>には例とかもっと詳しいガイドラインの紹介とかがあります\nそして fork した自分のリポジトリに push します</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> push <span class=\"token operator\">&lt;</span>my-github-username<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>branch名<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>\n<p>プルリクエストを出す</p>\n<p>普通に Github 上でプルリクを発行します。メッセージに自動で必要項目の雛形が出てくるので記入、チェックを入れて PR しましょう。1~2 日ぐらいでレビュー or マージしてくれます。みなさん優しくて不都合があっても教えてくれます。</p>\n<p>これで晴れて homebrew のコントリビュータになれました！！ヤッタネ！！</p>\n</li>\n<li>\n<p>最後に作業した環境を戻しておきます</p>\n<p>推奨されているのでやっときましょう</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token builtin class-name\">cd</span> <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span>brew --repository<span class=\"token variable\">)</span></span>\"</span>/Library/Taps/Homebrew/homebrew-cask\n$ <span class=\"token function\">git</span> checkout master</code></pre></div>\n</li>\n</ol>"}